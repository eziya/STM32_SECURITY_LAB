/*
 * boot.h
 *
 *  Created on: 2022. 8. 23.
 *      Author: jihoo
 */

#ifndef INC_BOOT_H_
#define INC_BOOT_H_

#include "main.h"


#define MAGIC_NUMBER        (0x08192A3C)
#define META_BLOCK_ADDR     (0x800A000)
#define META_DATA_LEN       (128U)
#define META_BLOCK_LEN      (0x200)
#define APP_ADDR            (META_BLOCK_ADDR+META_BLOCK_LEN)

#define HASH_LEN            (32U)
#define SIG_LEN             (64U)
#define ECC_PUB_LEN         (64U)

#define BL_SRAM1_START ((uint32_t)&_sdata)
#define BL_SRAM1_END ((uint32_t)&_eRAM)
#define BL_EXIT_STICKY 0x1FFF6800

typedef struct {
  uint32_t magicNum;                    //magic number
  uint32_t appSize;                     //application size
  uint32_t appVer;                      //application version
  uint8_t  appHash[HASH_LEN];           //application hash
  uint8_t  Reserved[84];                //padding bytes
  uint8_t  metaHash[HASH_LEN];          //meta data hash
  uint8_t  metaSig[SIG_LEN];            //meta data signature
}MetaBlock;

bool VerifyApplication(void);
void jump_to_application(void);

#endif /* INC_BOOT_H_ */
